[2023-05-09 19:13:10 INFO]Namespace(seed=20010920, device=device(type='cuda'), dataset='NYC', cell_type='N-ary', nary=3, user_embed_dim=128, POI_embed_dim=128, time_embed_dim=32, cat_embed_dim=32, lon_parts=32, lat_parts=32, coo_embed_dim=32, transformer_head_num=2, transformer_hid_dim=1024, transformer_layer_num=2, transformer_dropout=0.3, h_size=256, batch_size=1024, epochs=200, lr=0.001, lr_scheduler_factor=0.1, weight_decay=0.0005, need_plot_tree=False, workers=0, port=19923, save_path='./checkpoints/', load_path='')
[2023-05-09 19:13:23 INFO]
TreeLSTM(
  (user_embedding): Embedding(1047, 128)
  (POI_embedding): Embedding(4980, 128)
  (cat_embedding): Embedding(318, 32)
  (coo_embedding): Embedding(1024, 32)
  (l1): SineActivation()
  (dropout): Dropout(p=0.5, inplace=False)
  (cell): NaryTreeLSTMCell(
    (W_f): Linear(in_features=352, out_features=512, bias=False)
    (U_f): Linear(in_features=1536, out_features=1536, bias=False)
    (W_iou): Linear(in_features=352, out_features=1536, bias=False)
    (U_iou): Linear(in_features=1536, out_features=1536, bias=False)
    (transformer_encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-1): 2 x TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
          )
          (linear1): Linear(in_features=512, out_features=1024, bias=True)
          (dropout): Dropout(p=0.3, inplace=False)
          (linear2): Linear(in_features=1024, out_features=512, bias=True)
          (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.3, inplace=False)
          (dropout2): Dropout(p=0.3, inplace=False)
        )
      )
    )
  )
  (decoder_POI): Linear(in_features=512, out_features=4980, bias=True)
  (decoder_cat): Linear(in_features=512, out_features=318, bias=True)
)
[2023-05-09 19:13:23 INFO]
ReverseTreeLSTM(
  (user_embedding): Embedding(1047, 128)
  (POI_embedding): Embedding(4980, 128)
  (cat_embedding): Embedding(318, 32)
  (coo_embedding): Embedding(1024, 32)
  (l1): SineActivation()
  (dropout): Dropout(p=0.5, inplace=False)
  (cell): NaryTreeLSTMCell(
    (W_f): Linear(in_features=352, out_features=256, bias=False)
    (U_f): Linear(in_features=768, out_features=768, bias=False)
    (W_iou): Linear(in_features=352, out_features=768, bias=False)
    (U_iou): Linear(in_features=768, out_features=768, bias=False)
    (transformer_encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-1): 2 x TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=256, out_features=256, bias=True)
          )
          (linear1): Linear(in_features=256, out_features=1024, bias=True)
          (dropout): Dropout(p=0.3, inplace=False)
          (linear2): Linear(in_features=1024, out_features=256, bias=True)
          (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.3, inplace=False)
          (dropout2): Dropout(p=0.3, inplace=False)
        )
      )
    )
  )
)
