[2023-07-14 22:56:08 INFO]
TreeLSTM(
  (user_embedding): Embedding(1047, 128)
  (fuse_embedding): Embedding(6346, 128)
  (user_embedding_o): Embedding(1047, 128)
  (fuse_embedding_o): Embedding(6346, 128)
  (time_pos_encoder): Embedding(600, 256)
  (time_pos_encoder_o): Embedding(600, 256)
  (embed_dropout): Dropout(p=0.2, inplace=False)
  (model_dropout): Dropout(p=0.4, inplace=False)
  (cell): Cell(
    (W_f): Linear(in_features=256, out_features=512, bias=False)
    (U_f): Linear(in_features=1536, out_features=1536, bias=False)
    (W_iou): Linear(in_features=256, out_features=1536, bias=False)
    (U_iou): Linear(in_features=1536, out_features=1536, bias=False)
    (transformer_encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-1): 2 x TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
          )
          (linear1): Linear(in_features=512, out_features=512, bias=True)
          (dropout): Dropout(p=0.4, inplace=False)
          (linear2): Linear(in_features=512, out_features=512, bias=True)
          (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.4, inplace=False)
          (dropout2): Dropout(p=0.4, inplace=False)
        )
      )
    )
  )
  (cell_o): Cell(
    (W_f): Linear(in_features=256, out_features=512, bias=False)
    (U_f): Linear(in_features=1536, out_features=1536, bias=False)
    (W_iou): Linear(in_features=256, out_features=1536, bias=False)
    (U_iou): Linear(in_features=1536, out_features=1536, bias=False)
    (transformer_encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-1): 2 x TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
          )
          (linear1): Linear(in_features=512, out_features=512, bias=True)
          (dropout): Dropout(p=0.4, inplace=False)
          (linear2): Linear(in_features=512, out_features=512, bias=True)
          (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.4, inplace=False)
          (dropout2): Dropout(p=0.4, inplace=False)
        )
      )
    )
  )
  (decoder_POI): Linear(in_features=512, out_features=4980, bias=True)
  (decoder_cat): Linear(in_features=512, out_features=318, bias=True)
  (decoder_coo): Linear(in_features=512, out_features=1024, bias=True)
  (decoder_POI_o): Linear(in_features=512, out_features=4980, bias=True)
  (decoder_cat_o): Linear(in_features=512, out_features=318, bias=True)
  (decoder_coo_o): Linear(in_features=512, out_features=1024, bias=True)
)
[2023-07-14 22:56:08 INFO]
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0.0001
)
[2023-07-14 23:03:56 INFO]************************  Training epoch: 1/120  ************************
[2023-07-14 23:03:56 INFO]Current epoch's mean loss: 46.75342604042827		lr: 0.001
[2023-07-14 23:04:05 INFO]================================ Testing ================================
[2023-07-14 23:04:10 INFO] <POI> acc@1: 0.014803849000740192	acc@5: 0.043671354552183565	acc@10: 0.06686405132000987	acc@20: 0.09079694053787318	mrr: 0.03250693537286713
[2023-07-14 23:04:11 INFO] <cat> acc@1: 0.13693560325684678	acc@5: 0.3286454478164323	acc@10: 0.4562052800394769	acc@20: 0.5919072292129287	mrr: 0.23887808161280366
[2023-07-14 23:04:12 INFO] <coo> acc@1: 0.37207007155193683	acc@5: 0.7049099432519121	acc@10: 0.7846039970392302	acc@20: 0.8990870959782877	mrr: 0.5169192421922342
[2023-07-14 23:11:51 INFO]************************  Training epoch: 2/120  ************************
[2023-07-14 23:11:51 INFO]Current epoch's mean loss: 40.8737176646357		lr: 0.001
[2023-07-14 23:12:01 INFO]================================ Testing ================================
[2023-07-14 23:12:06 INFO] <POI> acc@1: 0.008635578583765112	acc@5: 0.03651616086849247	acc@10: 0.05872193436960276	acc@20: 0.09104367135455219	mrr: 0.02690487103884699
[2023-07-14 23:12:07 INFO] <cat> acc@1: 0.14828522082408094	acc@5: 0.32839871699975326	acc@10: 0.4660745127066371	acc@20: 0.6030101159634839	mrr: 0.24715475990363986
[2023-07-14 23:12:08 INFO] <coo> acc@1: 0.384653343202566	acc@5: 0.6935603256846781	acc@10: 0.8137182334073526	acc@20: 0.9146311374290649	mrr: 0.525304330051152
[2023-07-14 23:19:47 INFO]************************  Training epoch: 3/120  ************************
[2023-07-14 23:19:47 INFO]Current epoch's mean loss: 37.68681011476379		lr: 0.001
[2023-07-14 23:19:57 INFO]================================ Testing ================================
[2023-07-14 23:20:02 INFO] <POI> acc@1: 0.018011349617567233	acc@5: 0.051320009869232665	acc@10: 0.08166790032075007	acc@20: 0.12706637058968664	mrr: 0.04026419760709951
[2023-07-14 23:20:02 INFO] <cat> acc@1: 0.16086849247471008	acc@5: 0.34221564273377747	acc@10: 0.4830989390574883	acc@20: 0.6042437700468789	mrr: 0.2588751813832798
[2023-07-14 23:20:03 INFO] <coo> acc@1: 0.4228966197878115	acc@5: 0.7234147545028374	acc@10: 0.8314828522082408	acc@20: 0.9163582531458179	mrr: 0.5536591264421693
[2023-07-14 23:27:48 INFO]************************  Training epoch: 4/120  ************************
[2023-07-14 23:27:48 INFO]Current epoch's mean loss: 35.83710788229237		lr: 0.001
[2023-07-14 23:27:58 INFO]================================ Testing ================================
[2023-07-14 23:28:03 INFO] <POI> acc@1: 0.045645201085615594	acc@5: 0.10436713545521836	acc@10: 0.14359733530717986	acc@20: 0.19713792252652357	mrr: 0.0793499717305909
[2023-07-14 23:28:03 INFO] <cat> acc@1: 0.16728349370836418	acc@5: 0.37083641746854185	acc@10: 0.5035775968418456	acc@20: 0.6281766592647422	mrr: 0.2719355619449494
[2023-07-14 23:28:04 INFO] <coo> acc@1: 0.45891931902294597	acc@5: 0.7772020725388601	acc@10: 0.8667653589933383	acc@20: 0.9291882556131261	mrr: 0.597658290562596
[2023-07-14 23:35:44 INFO]************************  Training epoch: 5/120  ************************
[2023-07-14 23:35:44 INFO]Current epoch's mean loss: 34.13329977505449		lr: 0.001
[2023-07-14 23:35:54 INFO]================================ Testing ================================
[2023-07-14 23:35:59 INFO] <POI> acc@1: 0.06612385886997287	acc@5: 0.16062176165803108	acc@10: 0.22279792746113988	acc@20: 0.2844806316308907	mrr: 0.11587742568363323
[2023-07-14 23:35:59 INFO] <cat> acc@1: 0.17937330372563534	acc@5: 0.3903281519861831	acc@10: 0.5208487540093758	acc@20: 0.6429805082654824	mrr: 0.2878048562857582
[2023-07-14 23:36:00 INFO] <coo> acc@1: 0.4816185541574143	acc@5: 0.8161855415741426	acc@10: 0.8845299777942265	acc@20: 0.9476930668640513	mrr: 0.6272379209258437
[2023-07-14 23:43:46 INFO]************************  Training epoch: 6/120  ************************
[2023-07-14 23:43:46 INFO]Current epoch's mean loss: 32.504513383948286		lr: 0.0009000000000000001
[2023-07-14 23:43:56 INFO]================================ Testing ================================
[2023-07-14 23:44:01 INFO] <POI> acc@1: 0.10066617320503331	acc@5: 0.23612139156180606	acc@10: 0.29212928694793977	acc@20: 0.3587466074512707	mrr: 0.1653874908514744
[2023-07-14 23:44:02 INFO] <cat> acc@1: 0.19121638292622747	acc@5: 0.41919565753762644	acc@10: 0.53960029607698	acc@20: 0.6639526276831976	mrr: 0.3055932617971899
[2023-07-14 23:44:03 INFO] <coo> acc@1: 0.5006168270416975	acc@5: 0.840858623242043	acc@10: 0.9035282506785097	acc@20: 0.9575622995312114	mrr: 0.6466550399952038
[2023-07-14 23:51:45 INFO]************************  Training epoch: 7/120  ************************
[2023-07-14 23:51:45 INFO]Current epoch's mean loss: 30.995575161256653		lr: 0.0009000000000000001
[2023-07-14 23:51:55 INFO]================================ Testing ================================
[2023-07-14 23:52:00 INFO] <POI> acc@1: 0.12854675548976066	acc@5: 0.2867012089810017	acc@10: 0.35134468295090054	acc@20: 0.41278065630397237	mrr: 0.202862138188239
[2023-07-14 23:52:00 INFO] <cat> acc@1: 0.19861830742659758	acc@5: 0.4396743153219837	acc@10: 0.5539106834443622	acc@20: 0.6799901307673328	mrr: 0.31857500606980416
[2023-07-14 23:52:01 INFO] <coo> acc@1: 0.5171477917591907	acc@5: 0.8509745867258821	acc@10: 0.9133974833456698	acc@20: 0.9684184554650875	mrr: 0.6618934207904815
[2023-07-14 23:59:49 INFO]************************  Training epoch: 8/120  ************************
[2023-07-14 23:59:49 INFO]Current epoch's mean loss: 29.84243177883867		lr: 0.0009000000000000001
[2023-07-14 23:59:59 INFO]================================ Testing ================================
[2023-07-15 00:00:04 INFO] <POI> acc@1: 0.15173945225758698	acc@5: 0.32938564026646927	acc@10: 0.4058721934369603	acc@20: 0.4722427831236121	mrr: 0.23393808710253194
[2023-07-15 00:00:04 INFO] <cat> acc@1: 0.20305946212681963	acc@5: 0.4549716259560819	acc@10: 0.5674808783617074	acc@20: 0.690106094251172	mrr: 0.3267670315521954
[2023-07-15 00:00:05 INFO] <coo> acc@1: 0.5240562546262029	acc@5: 0.8638045891931903	acc@10: 0.9272144090796941	acc@20: 0.9735998026153466	mrr: 0.6715205526571554
[2023-07-15 00:07:43 INFO]************************  Training epoch: 9/120  ************************
[2023-07-15 00:07:43 INFO]Current epoch's mean loss: 28.780471646958503		lr: 0.0009000000000000001
[2023-07-15 00:07:53 INFO]================================ Testing ================================
[2023-07-15 00:07:58 INFO] <POI> acc@1: 0.17320503330866024	acc@5: 0.3760177646188009	acc@10: 0.44411547002220575	acc@20: 0.5090056748087837	mrr: 0.26570637683778997
[2023-07-15 00:07:58 INFO] <cat> acc@1: 0.20922773254379473	acc@5: 0.4665679743399951	acc@10: 0.5815445349124105	acc@20: 0.7036762891685171	mrr: 0.33429551567505694
[2023-07-15 00:07:59 INFO] <coo> acc@1: 0.5361460646434739	acc@5: 0.8763878608438194	acc@10: 0.9314088329632371	acc@20: 0.9768073032321737	mrr: 0.6824191958760406
